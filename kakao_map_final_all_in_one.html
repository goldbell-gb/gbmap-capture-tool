<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ì¹´ì¹´ì˜¤ ì§€ë„ ìº¡ì²˜ íˆ´</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        font-family: sans-serif;
        overflow: scroll;
      }
      #map-wrapper {
        width: 9000px;
        height: 9000px;
        overflow: scroll;
      }
      #map {
        width: 9000px;
        height: 9000px;
      }
      #toolbar {
        position: fixed;
        top: 10px;
        left: 10px;
        background: rgba(255, 255, 255, 0.95);
        padding: 10px;
        border-radius: 10px;
        z-index: 100;
      }
      input, select, button {
        margin: 4px 0;
      }
    </style>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b0bf0079d2279c9cef60d94996a263b6&libraries=services"></script>
  </head>
  <body>
    <div id="toolbar">
      <div>
        ì§€ë„ ìœ í˜•:
        <select id="mapType">
          <option value="ROADMAP">ì¼ë°˜ì§€ë„</option>
          <option value="HYBRID">í•˜ì´ë¸Œë¦¬ë“œ</option>
          <option value="SATELLITE">ìœ„ì„±ì§€ë„</option>
        </select>
      </div>
      <div>
        ì£¼ì†Œ ê²€ìƒ‰:
        <input type="text" id="addr" placeholder="ì˜ˆ: êµ¬ë°˜í¬ì—­" />
        <button onclick="moveToAddress()">ì£¼ì†Œë¡œ ì´ë™</button>
      </div>
      <div>
        ì§€ë„ í¬ê¸°(px):<br />
        ê°€ë¡œ: <input type="number" id="width" value="9000" /> <br />
        ì„¸ë¡œ: <input type="number" id="height" value="9000" />
      </div>
      <div>
        ì¤Œ ë ˆë²¨:
        <select id="zoom">
          <option value="1">1 (ìµœì†Œ í™•ëŒ€)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5" selected>5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10 (ìµœëŒ€ í™•ëŒ€)</option>
        </select>
      </div>
      <button onclick="applySettings()">ì„¤ì • ì ìš©</button><br />
      <button onclick="savePosition()">ğŸ“Œ í˜„ì¬ ìœ„ì¹˜ ì €ì¥</button>
      <button onclick="restorePosition()">ğŸ“ ìœ„ì¹˜ ë³µì›</button>
      <button onclick="scrollToMapCenter()">ğŸ¯ ì¤‘ì•™ ë§ì¶”ê¸°</button>
    </div>
    <div id="map-wrapper">
      <div id="map"></div>
    </div>
    <script>
      let map;
      let marker = null;
      let savedCenter = null;

      function initMap() {
        const container = document.getElementById("map");
        const options = {
          center: new kakao.maps.LatLng(37.503063, 126.996637),
          level: parseInt(document.getElementById("zoom").value)
        };
        map = new kakao.maps.Map(container, options);

        kakao.maps.event.addListener(map, 'zoom_changed', function() {
          setTimeout(scrollToMapCenter, 300);
        });

        kakao.maps.event.addListener(map, 'idle', function onceIdle() {
          scrollToMapCenter();
          kakao.maps.event.removeListener(map, 'idle', onceIdle);
        });

        kakao.maps.event.addListener(map, 'click', function(mouseEvent) {
          if (!document.getElementById("markerToggle").checked) return;
          const latlng = mouseEvent.latLng;
          if (marker) marker.setMap(null);
          marker = new kakao.maps.Marker({ position: latlng });
          marker.setMap(map);
        });
      }

      function moveToAddress() {
        const addr = document.getElementById("addr").value;
        const geocoder = new kakao.maps.services.Geocoder();
        geocoder.addressSearch(addr, function(result, status) {
          if (status === kakao.maps.services.Status.OK) {
            const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
            map.setCenter(coords);
            if (document.getElementById("markerToggle").checked) {
              if (marker) marker.setMap(null);
              marker = new kakao.maps.Marker({ position: coords });
              marker.setMap(map);
            }
            setTimeout(scrollToMapCenter, 300);
          }
        });
      }

      function applySettings() {
        const width = parseInt(document.getElementById("width").value);
        const height = parseInt(document.getElementById("height").value);
        const level = parseInt(document.getElementById("zoom").value);
        const type = document.getElementById("mapType").value;

        document.getElementById("map").style.width = width + "px";
        document.getElementById("map").style.height = height + "px";
        document.getElementById("map-wrapper").style.width = width + "px";
        document.getElementById("map-wrapper").style.height = height + "px";

        map.setLevel(level);
        map.relayout();

        if (type === "ROADMAP") map.setMapTypeId(kakao.maps.MapTypeId.ROADMAP);
        else if (type === "SATELLITE") map.setMapTypeId(kakao.maps.MapTypeId.SKYVIEW);
        else if (type === "HYBRID") map.setMapTypeId(kakao.maps.MapTypeId.HYBRID);

        resizeDocumentToMap();
        setTimeout(scrollToMapCenter, 300);
      }

      function savePosition() {
        savedCenter = map.getCenter();
        alert("í˜„ì¬ ìœ„ì¹˜ ì €ì¥ë¨!");
      }

      function restorePosition() {
        if (savedCenter) {
          map.setCenter(savedCenter);
          setTimeout(scrollToMapCenter, 300);
        }
      }

      function scrollToMapCenter() {
        const mapDiv = document.getElementById("map");
        const center = map.getCenter();
        const projection = map.getProjection();
        const point = projection.containerPointFromCoords(center);
        const scrollLeft = point.x - window.innerWidth / 2;
        const scrollTop = point.y - window.innerHeight / 2;
        window.scrollTo(scrollLeft, scrollTop);
      }

      function resizeDocumentToMap() {
        const width = parseInt(document.getElementById("width").value);
        const height = parseInt(document.getElementById("height").value);
        document.documentElement.style.width = width + "px";
        document.documentElement.style.height = height + "px";
        document.body.style.width = width + "px";
        document.body.style.height = height + "px";
      }

      document.getElementById("width").addEventListener("change", resizeDocumentToMap);
      document.getElementById("height").addEventListener("change", resizeDocumentToMap);

      window.onload = () => {
        initMap();
        resizeDocumentToMap();
      };
    </script>
  </body>
</html>